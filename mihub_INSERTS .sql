


########### PROCESS ###########



insert into bietldb.`mihub_process` (`proc_id`, `proc_typ`, `proc_nm`, `job_desc`, `job_path`, `run_frequency`, `source_db`, `fact_db`, `rpt_table_nm`, `fact_table_nm`, `test_yard`, `source_sql`, `created_dt`, `updated_dt`) values('929','CLEARANCE_AND_AUTH','UKCA',NULL,NULL,'Every 1 Day',NULL,NULL,NULL,NULL,NULL,NULL,'2022-04-19 05:36:53','2022-04-20 05:53:25');






######## STEPS ###############


insert into miconfig.`mihub_step` (`step_id`, `process_id`, `extract_id`, `etl_tool`, `step_name`, `src_db_schema`, `tgt_db_schema`, `is_active`, `is_yard_level`, `step_sequence`, `updated_at`, `job_path`) values('8001','929',NULL,'PDI','TRUNCATE BIETLDB TABLES','bietldb','bietldb','Y','','1','2022-04-20 05:36:53','/home/admin/MIHUB_GLOBAL/KJB_DELTA_LOAD');
insert into miconfig.`mihub_step` (`step_id`, `process_id`, `extract_id`, `etl_tool`, `step_name`, `src_db_schema`, `tgt_db_schema`, `is_active`, `is_yard_level`, `step_sequence`, `updated_at`, `job_path`) values('8002','929',NULL,'PDI','LOAD DATA FROM UKCA TO BIETLDB','yds','bietldb','Y','','2','2022-04-21 04:35:01','/home/admin/MIHUB_GLOBAL/KJB_GET_SOURCE_DATA');
insert into miconfig.`mihub_step` (`step_id`, `process_id`, `extract_id`, `etl_tool`, `step_name`, `src_db_schema`, `tgt_db_schema`, `is_active`, `is_yard_level`, `step_sequence`, `updated_at`, `job_path`) values('8003','929',NULL,'PDI','TRUNCATE RPT TABLES','rptstage','rptstage','Y',NULL,'3','2022-04-22 08:48:18','/home/admin/MIHUB_GLOBAL/KJB_DELTA_LOAD');
insert into miconfig.`mihub_step` (`step_id`, `process_id`, `extract_id`, `etl_tool`, `step_name`, `src_db_schema`, `tgt_db_schema`, `is_active`, `is_yard_level`, `step_sequence`, `updated_at`, `job_path`) values('8004','929',NULL,'PDI','LOAD RPT from BIETLDB','bietldb','rptstage','Y',NULL,'4','2022-04-22 08:48:18','/home/admin/MIHUB_GLOBAL/KJB_GET_SOURCE_DATA');
insert into miconfig.`mihub_step` (`step_id`, `process_id`, `extract_id`, `etl_tool`, `step_name`, `src_db_schema`, `tgt_db_schema`, `is_active`, `is_yard_level`, `step_sequence`, `updated_at`, `job_path`) values('8005','929',NULL,'PDI','Pre-Delete and LOAD UKMART FROM RPT','rptstage','ukmart','Y','','5','2022-04-20 05:36:53','/home/admin/MIHUB_GLOBAL/KJB_DELTA_LOAD');




#####STEP DETAILS ############

insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8301','8001','TRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_requests` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_request_tasks` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_request_subtasks` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_event_logs` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_message_details` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_message_headers` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_request_attributes` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_request_subtask_attributes` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_subtask_type_codes` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_subtask_types` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_task_types` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_status_codes` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_stages` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_reference_codes` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_reference_categories` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_reason_codes` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_reason_categories` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_message_types` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_message_categories` ;\r\n\r\nTRUNCATE TABLE ${tgt_db_schema}.`rpt_ca_attribute_types` ;','NA',NULL,'NA',NULL,'2022-04-20 05:36:53','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',\r\n	COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',\r\n	count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8302','8002','SELECT \r\nca_rqst_id,\r\nlot_nbr,\r\nslr_cd,\r\nclaim_nbr,\r\nclearance_dttm,\r\nclearance_stg_cd,\r\nclearance_rqst_status,\r\nauthorized_dttm,\r\ncrush_authorized_dttm,\r\ncrush_flg,\r\nclr_flg,\r\npreclr_flg,\r\nnxt_cntct_dt,\r\nslr_nxt_rvw_dt,\r\nrqst_crt_dt,\r\nrqst_cmpltd_dt,\r\nlast_actn_dt,\r\nlast_actn_entity_type,\r\nlast_actn_entity,\r\nca_hld_dt,\r\nca_hld_rsn,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt, \r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM (\r\n\r\n\r\nSELECT\r\nca_rqst_id ca_rqst_id,\r\nlot_num  lot_nbr,\r\nslr_cd slr_cd,\r\nclaim_num  claim_nbr,\r\nclr_dt  clearance_dttm,\r\nca_stg_cd  clearance_stg_cd,\r\nca_rqst_status  clearance_rqst_status,\r\nca_auth_dt  authorized_dttm,\r\ncrush_auth_dt crush_authorized_dttm,\r\ncrush_flg crush_flg,\r\nclr_flg clr_flg,\r\npreclr_flg preclr_flg,\r\nnxt_cntct_dt nxt_cntct_dt,\r\nslr_nxt_rvw_dt slr_nxt_rvw_dt,\r\nrqst_crt_dt rqst_crt_dt,\r\nrqst_cmpltd_dt rqst_cmpltd_dt,\r\nlast_actn_dt last_actn_dt,\r\nlast_actn_entity_type last_actn_entity_type,\r\nlast_actn_entity last_actn_entity,\r\nca_hld_dt ca_hld_dt,\r\nca_hld_rsn ca_hld_rsn,\r\nSTATUS STATUS,\r\ncrt_user crt_user,\r\ncrt_dt crt_dt, \r\nlast_upd_user last_upd_user,\r\nlast_upd_dt last_upd_dt,\r\nsource_sys source_sys\r\nFROM yds.ca_requests\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\'\r\n) A\r\n;','ca_requests',NULL,'rpt_ca_requests',NULL,'2022-04-21 06:35:39','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8303','8002','SELECT\r\nca_rqst_task_id,\r\nca_rqst_id,\r\nentity_type,\r\nentity_id,\r\ntask_type_cd,\r\ntask_status_cd,\r\nnxt_cntct_dt,\r\ntask_cmpltd_dt,\r\ntask_crt_dt,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_request_tasks\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_request_tasks',NULL,'rpt_ca_request_tasks',NULL,'2022-04-21 06:35:39','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8304','8002','SELECT\r\nca_rqst_sbtask_id,\r\nca_rqst_task_id,\r\nca_rqst_id,\r\nsbtask_type_cd,\r\nsbtask_cd,\r\nsbtask_status_cd,\r\nclose_rsn_cd,\r\nnxt_cntct_dt,\r\nsla_cntct_dt,\r\nlast_cntct_dt,\r\nsbtask_cmpltd_dt,\r\ncntct_rslt_cd,\r\n#sbtask_stg_cd,\r\nsbtask_crt_dt,\r\nSTATUS,\r\ncrt_dt,\r\ncrt_user,\r\nlast_upd_dt,\r\nlast_upd_user,\r\nsource_sys\r\nFROM ca_request_subtasks\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_request_subtasks',NULL,'rpt_ca_request_subtasks',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8305','8002','SELECT\r\nca_msg_dtl_id,\r\nca_msg_hdr_id,\r\nfrom_entity_type,\r\nfrom_entity,\r\nto_entity_type,\r\nto_entity,\r\ncomments,\r\nmsg_dtl_json,\r\nmsg_dtl_ack_flg,\r\nmsg_dtl_status,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_message_details\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_message_details',NULL,'rpt_ca_message_details',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8306','8002','SELECT\r\nca_msg_hdr_id,\r\nca_rqst_id,\r\nca_rqst_task_id,\r\nca_rqst_sbtask_id,\r\nmsg_cat_cd,\r\nmsg_type_cd,\r\nmsg_hdr_json,\r\nmsg_status,\r\n#resp_entity,\r\n#resp_entity_id,\r\n#resp_comments,\r\n#resp_type_cd,\r\nSTATUS,\r\ncrt_dt,\r\ncrt_user,\r\nlast_upd_dt,\r\nlast_upd_user,\r\nsource_sys\r\nFROM ca_message_headers\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_message_headers',NULL,'rpt_ca_message_headers',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8307','8002','SELECT\r\nca_rqst_attr_id,\r\nca_rqst_id,\r\nattr_type_cd,\r\nattr_json_val,\r\nattr_status,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_request_attributes\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_request_attributes',NULL,'rpt_ca_request_attributes',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8308','8002','SELECT\r\nca_sbtask_attr_id,\r\nca_rqst_sbtask_id,\r\nattr_type_cd,\r\nattr_json_val,\r\nattr_status,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_request_subtask_attributes\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_request_subtask_attributes',NULL,'rpt_ca_request_subtask_attributes',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8309','8002','SELECT\r\nsbtask_type_cd,\r\nsbtask_type_desc,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_subtask_type_codes\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'   AND \'${OUT_END_DT}\';','ca_subtask_type_codes',NULL,'rpt_ca_subtask_type_codes',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8310','8002','SELECT\r\nca_task_type_cd,\r\nca_sbtask_type_cd,\r\nca_sbtask_cd,\r\nca_sbtask_desc,\r\nproperties_json,\r\ncntct_due_time,\r\ncntct_flup_time,\r\nsbtask_priority,\r\nSTATUS,\r\ncrt_dt,\r\ncrt_user,\r\nlast_upd_dt,\r\nlast_upd_user,\r\nsource_sys\r\nFROM ca_subtask_types\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_subtask_types',NULL,'rpt_ca_subtask_types',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8311','8002','SELECT\r\ntask_type_cd,\r\ntask_type_desc,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_task_types\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_task_types',NULL,'rpt_ca_task_types',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8312','8002','SELECT\r\nca_cat_cd,\r\nca_status_cd,\r\nca_status_desc,\r\nSTATUS,\r\ncrt_dt,\r\ncrt_user,\r\nlast_upd_dt,\r\nlast_upd_user,\r\nsource_sys\r\nFROM ca_status_codes\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_status_codes',NULL,'rpt_ca_status_codes',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8313','8002','SELECT\r\nca_cat_cd,\r\nca_stg_cd,\r\nca_stg_desc,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_stages\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_stages',NULL,'rpt_ca_stages',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8314','8002','SELECT\r\nca_ref_cat_cd,\r\nca_ref_cd,\r\nca_ref_desc,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_reference_codes\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\' AND \'${OUT_END_DT}\';','ca_reference_codes',NULL,'rpt_ca_reference_codes',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8315','8002','SELECT\r\nca_ref_cat_cd,\r\nca_ref_cat_desc,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_reference_categories\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_reference_categories',NULL,'rpt_ca_reference_categories',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8316','8002','SELECT\r\nca_rsn_cat_cd,\r\nca_rsn_cd,\r\nca_rsn_desc,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_reason_codes\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_reason_codes',NULL,'rpt_ca_reason_codes',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8317','8002','SELECT\r\nca_rsn_cat_cd,\r\nca_rsn_cat_desc,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_reason_categories\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_reason_categories',NULL,'rpt_ca_reason_categories',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8318','8002','SELECT\r\nmsg_cat_cd,\r\nmsg_type_cd,\r\nmsg_type_desc,\r\nmsg_type_json,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_message_types\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_message_types',NULL,'rpt_ca_message_types',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8319','8002','SELECT\r\nmsg_cat_cd,\r\nmsg_cat_desc,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_message_categories\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\' AND \'${OUT_END_DT}\';','ca_message_categories',NULL,'rpt_ca_message_categories',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8320','8002','SELECT\r\nattr_type_cat_cd,\r\nattr_type_cd,\r\nattr_type_nm,\r\nSTATUS,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM ca_attribute_types\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\'  AND \'${OUT_END_DT}\';','ca_attribute_types',NULL,'rpt_ca_attribute_types',NULL,'2022-04-21 06:39:38','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8321','8002','select\r\nca_event_log_id,\r\nlot_num,\r\nref_cd,\r\nref_id,\r\nevent_cd,\r\nevent_notes,\r\nevent_json,\r\ntrgrd_by_entity,\r\ntrgrd_by,\r\ntrgrd_dt,\r\nstatus,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nfrom\r\nca_event_logs\r\nWHERE last_upd_dt BETWEEN  \'${OUT_START_DT}\' AND \'${OUT_END_DT}\';','ca_event_logs',NULL,'rpt_ca_event_logs',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_YDS_SRC','DS_BIETLDB_SRC','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8322','8003','TRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_fact_requests_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_fact_entities_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_fact_events_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_fact_message_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_request_attributes_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_request_subtask_attributes_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_subtask_type_codes_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_subtask_types_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_task_types_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_status_codes_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_stages_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_reference_codes_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_reference_categories_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_reason_codes_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_reason_categories_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_message_types_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_message_categories_ca ;\r\nTRUNCATE TABLE  ${tgt_db_schema}.rpt_uk_dim_attribute_types_ca ;','NA',NULL,'NA',NULL,'2022-04-20 05:36:53','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_USMART_TGT','DS_USMART_TGT','SELECT 1 AS \'Check\',\r\n	COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',\r\n	count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8323','8004','SELECT\r\nca_rqst_id,\r\nlot_nbr,\r\nslr_cd,\r\nclaim_nbr,\r\nclearance_dttm,\r\nclearance_stg_cd,\r\nclearance_rqst_status,\r\nauthorized_dttm,\r\ncrush_authorized_dttm,\r\ncrush_flg,\r\nclr_flg,\r\npreclr_flg,\r\nnxt_cntct_dt,\r\nslr_nxt_rvw_dt,\r\nrqst_crt_dt,\r\nrqst_cmpltd_dt,\r\nlast_actn_dt,\r\nlast_actn_entity_type,\r\nlast_actn_entity,\r\nca_hld_dt,\r\nca_hld_rsn,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\n${src_db_schema}.rpt_ca_requests;','rpt_ca_requests',NULL,'rpt_uk_fact_requests_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8324','8004','SELECT \r\nentity_id,\r\nentity_type,\r\nca_rqst_sbtask_id,\r\nsbtask_type_cd,\r\nsbtask_cd,\r\nsbtask_status_cd,\r\nclose_rsn_cd,\r\nsla_cntct_dt,\r\nlast_cntct_dt,\r\nsbtask_cmpltd_dt,\r\ncntct_rslt_cd,\r\nsbtask_stg_cd,\r\nsbtask_crt_dt,\r\nca_rqst_task_id,\r\nca_rqst_id,\r\nnxt_cntct_dt,\r\nSTATUS,\r\nbatch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys,\r\ntask_type_cd,\r\ntask_status_cd,\r\ntask_cmpltd_dt,\r\ntask_crt_dt\r\nFROM\r\n(\r\nSELECT\r\nca_rqst_task_id entity_id,\r\n\'tasks\' entity_type,\r\nNULL ca_rqst_sbtask_id,\r\nNULL sbtask_type_cd,\r\nNULL sbtask_cd,\r\nNULL sbtask_status_cd,\r\nNULL close_rsn_cd,\r\nNULL sla_cntct_dt,\r\nNULL last_cntct_dt,\r\nNULL sbtask_cmpltd_dt,\r\nNULL cntct_rslt_cd,\r\nNULL sbtask_stg_cd,\r\nNULL sbtask_crt_dt,\r\nca_rqst_task_id,\r\nca_rqst_id,\r\nnxt_cntct_dt,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys,\r\ntask_type_cd,\r\ntask_status_cd,\r\ntask_cmpltd_dt,\r\ntask_crt_dt\r\nFROM\r\n${src_db_schema}.rpt_ca_request_tasks\r\nUNION ALL\r\nSELECT\r\nca_rqst_sbtask_id entity_id,\r\n\'subtasks\' entity_type,\r\nca_rqst_sbtask_id,\r\nsbtask_type_cd,\r\nsbtask_cd,\r\nsbtask_status_cd,\r\nclose_rsn_cd,\r\nsla_cntct_dt,\r\nlast_cntct_dt,\r\nsbtask_cmpltd_dt,\r\ncntct_rslt_cd,\r\nNULL sbtask_stg_cd,\r\nsbtask_crt_dt,\r\nca_rqst_task_id,\r\nca_rqst_id,\r\nnxt_cntct_dt,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys,\r\nNULL task_type_cd,\r\nNULL task_status_cd,\r\nNULL task_cmpltd_dt,\r\nNULL task_crt_dt\r\nFROM\r\n${src_db_schema}.rpt_ca_request_subtasks\r\n) A ;\r\n','rpt_ca_request_tasks,rpt_ca_request_subtasks',NULL,'rpt_uk_fact_entities_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8325','8004','SELECT \r\nca_event_log_id,\r\nlot_nbr,\r\nref_cd,\r\nref_id,\r\nevent_cd,\r\nevent_notes,\r\nevent_json,\r\ntrgrd_by_entity,\r\ntrgrd_by,\r\ntrgrd_dt,\r\nSTATUS,\r\nbatch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM \r\n(\r\n\r\nSELECT\r\nca_event_log_id,\r\nlot_num lot_nbr,\r\nref_cd,\r\nref_id,\r\nevent_cd,\r\nevent_notes,\r\nevent_json,\r\ntrgrd_by_entity,\r\ntrgrd_by,\r\ntrgrd_dt,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_event_logs\r\n) A;\r\n\r\n\r\n \r\n','rpt_ca_event_logs',NULL,'rpt_uk_fact_events_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8326','8004','SELECT\r\nentity_id,\r\nentity_type,\r\nca_msg_dtl_id,\r\nfrom_entity_type,\r\nfrom_entity,\r\nto_entity_type,\r\nto_entity,\r\ncomments,\r\nmsg_dtl_json,\r\nmsg_dtl_ack_flg,\r\nmsg_dtl_status,\r\nca_msg_hdr_id,\r\nca_rqst_id,\r\nca_rqst_task_id,\r\nca_rqst_sbtask_id,\r\nmsg_cat_cd,\r\nmsg_type_cd,\r\nmsg_hdr_json,\r\nmsg_status,\r\nresp_entity,\r\nresp_entity_id,\r\nresp_comments,\r\nresp_type_cd,\r\nSTATUS,\r\nbatch_nbr,\r\ncrt_dt,\r\ncrt_user,\r\nlast_upd_dt,\r\nlast_upd_user,\r\nsource_sys\r\nFROM \r\n(\r\nSELECT\r\nca_msg_dtl_id entity_id,\r\n\'detail\' entity_type,\r\nca_msg_dtl_id,\r\nfrom_entity_type,\r\nfrom_entity,\r\nto_entity_type,\r\nto_entity,\r\ncomments,\r\nmsg_dtl_json,\r\nmsg_dtl_ack_flg,\r\nmsg_dtl_status,\r\nca_msg_hdr_id,\r\nNULL ca_rqst_id,\r\nNULL ca_rqst_task_id,\r\nNULL ca_rqst_sbtask_id,\r\nNULL msg_cat_cd,\r\nNULL msg_type_cd,\r\nNULL msg_hdr_json,\r\nNULL msg_status,\r\nNULL resp_entity,\r\nNULL resp_entity_id,\r\nNULL resp_comments,\r\nNULL resp_type_cd,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_dt,\r\ncrt_user,\r\nlast_upd_dt,\r\nlast_upd_user,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_message_details\r\nUNION ALL \r\nSELECT\r\nca_msg_hdr_id entity_id,\r\n\'header\' entity_type,\r\nNULL ca_msg_dtl_id,\r\nNULL from_entity_type,\r\nNULL from_entity,\r\nNULL to_entity_type,\r\nNULL to_entity,\r\nNULL comments,\r\nNULL msg_dtl_json,\r\nNULL msg_dtl_ack_flg,\r\nNULL msg_dtl_status,\r\nca_msg_hdr_id,\r\nca_rqst_id,\r\nca_rqst_task_id,\r\nca_rqst_sbtask_id,\r\nmsg_cat_cd,\r\nmsg_type_cd,\r\nmsg_hdr_json,\r\nmsg_status,\r\nNULL resp_entity,\r\nNULL resp_entity_id,\r\nNULL resp_comments,\r\nNULL resp_type_cd,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_dt,\r\ncrt_user,\r\nlast_upd_dt,\r\nlast_upd_user,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_message_headers\r\n) A;\r\n\r\n','rpt_ca_message_details,rpt_ca_message_headers',NULL,'rpt_uk_fact_message_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8327','8004','SELECT\r\nca_rqst_attr_id,\r\nca_rqst_id,\r\nattr_type_cd,\r\nattr_json_val,\r\nattr_status,\r\nstatus,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_request_attributes\r\n;\r\n\r\n','rpt_ca_request_attributes',NULL,'rpt_uk_dim_request_attributes_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8328','8004','SELECT\r\nca_sbtask_attr_id,\r\nca_rqst_sbtask_id,\r\nattr_type_cd,\r\nattr_json_val,\r\nattr_status,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_request_subtask_attributes\r\n;\r\n\r\n\r\n\r\n','rpt_ca_request_subtask_attributes',NULL,'rpt_uk_dim_request_subtask_attributes_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8329','8004','SELECT\r\nsbtask_type_cd,\r\nsbtask_type_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_subtask_type_codes\r\n;\r\n','rpt_ca_subtask_type_codes',NULL,'rpt_uk_dim_subtask_type_codes_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8330','8004','SELECT\r\nca_task_type_cd,\r\nca_sbtask_type_cd,\r\nca_sbtask_cd,\r\nca_sbtask_desc,\r\nproperties_json,\r\ncntct_due_time,\r\ncntct_flup_time,\r\nsbtask_priority,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_dt,\r\ncrt_user,\r\nlast_upd_dt,\r\nlast_upd_user,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_subtask_types\r\n;\r\n','rpt_ca_subtask_types',NULL,'rpt_uk_dim_subtask_types_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8331','8004','SELECT\r\ntask_type_cd,\r\ntask_type_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_task_types\r\n;\r\n','rpt_ca_task_types',NULL,'rpt_uk_dim_task_types_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8332','8004','SELECT\r\nca_cat_cd,\r\nca_status_cd,\r\nca_status_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_dt,\r\ncrt_user,\r\nlast_upd_dt,\r\nlast_upd_user,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_status_codes\r\n;','rpt_ca_status_codes',NULL,'rpt_uk_dim_status_codes_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8333','8004','SELECT\r\nca_cat_cd,\r\nca_stg_cd,\r\nca_stg_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_stages;','rpt_ca_stages',NULL,'rpt_uk_dim_stages_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8334','8004','\r\nSELECT\r\nca_ref_cat_cd,\r\nca_ref_cd,\r\nca_ref_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_reference_codes\r\n;','rpt_ca_reference_codes',NULL,'rpt_uk_dim_reference_codes_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8335','8004','SELECT\r\nca_ref_cat_cd,\r\nca_ref_cat_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_reference_categories\r\n;','rpt_ca_reference_categories',NULL,'rpt_uk_dim_reference_categories_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8336','8004','\r\nSELECT\r\nca_rsn_cat_cd,\r\nca_rsn_cd,\r\nca_rsn_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM\r\nbietldb.rpt_ca_reason_codes\r\n;','rpt_ca_reason_codes',NULL,'rpt_uk_dim_reason_codes_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8337','8004','SELECT\r\nca_rsn_cat_cd,\r\nca_rsn_cat_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM \r\nbietldb.rpt_ca_reason_categories\r\n;','rpt_ca_reason_categories',NULL,'rpt_uk_dim_reason_categories_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8338','8004','SELECT\r\nmsg_cat_cd,\r\nmsg_type_cd,\r\nmsg_type_desc,\r\nmsg_type_json,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM \r\nbietldb.rpt_ca_message_types\r\n;','rpt_ca_message_types',NULL,'rpt_uk_dim_message_types_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8339','8004','SELECT\r\nmsg_cat_cd,\r\nmsg_cat_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM \r\nbietldb.rpt_ca_message_categories;\r\n','rpt_ca_message_categories',NULL,'rpt_uk_dim_message_categories_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8340','8004','SELECT\r\nattr_type_cat_cd,\r\nattr_type_cd,\r\nattr_type_nm,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\ncrt_user,\r\ncrt_dt,\r\nlast_upd_user,\r\nlast_upd_dt,\r\nsource_sys\r\nFROM \r\nbietldb.rpt_ca_attribute_types\r\n;\r\n','rpt_ca_attribute_types',NULL,'rpt_uk_dim_attribute_types_ca',NULL,'2022-04-22 11:19:20','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_BIETLDB_SRC','DS_USMART_TGT','SELECT 1 AS \'Check\',COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',count(*) as tgt_valid_cnt;');
insert into miconfig.`mihub_step_details` (`step_detail_id`, `step_id`, `procedure_name`, `source_tablename`, `intermediate_tablename`, `target_table`, `report_name`, `updated_at`, `file_location`, `file_pattern`, `file_separator`, `delete_criteria_col`, `validation_sql`, `rollback_sql`, `detail_sequence`, `email_type`, `is_active`, `src_db_conn`, `tgt_db_conn`, `src_validation`, `tgt_validation`) values('8341','8005','DELETE uk_req FROM ${tgt_db_schema}.`uk_fact_requests_ca` uk_req  JOIN  ${src_db_schema}.rpt_uk_fact_requests_ca rpt_req ON uk_req.ca_rqst_id = rpt_req.ca_rqst_id;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`uk_fact_requests_ca`\r\n( \r\nca_rqst_id,\r\nlot_nbr,\r\nslr_cd,\r\nclaim_nbr,\r\nclearance_dttm,\r\nclearance_stg_cd,\r\nclearance_rqst_status,\r\nauthorized_dttm,\r\ncrush_authorized_dttm,\r\ncrush_flg,\r\nclr_flg,\r\npreclr_flg,\r\nnxt_cntct_dt,\r\nslr_nxt_rvw_dt,\r\nrqst_crt_dt,\r\nrqst_cmpltd_dt,\r\nlast_actn_dt,\r\nlast_actn_entity_type,\r\nlast_actn_entity,\r\nca_hld_dt,\r\nca_hld_rsn,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\n \r\nSELECT \r\nca_rqst_id,\r\nlot_nbr,\r\nslr_cd,\r\nclaim_nbr,\r\nclearance_dttm,\r\nclearance_stg_cd,\r\nclearance_rqst_status,\r\nauthorized_dttm,\r\ncrush_authorized_dttm,\r\ncrush_flg,\r\nclr_flg,\r\npreclr_flg,\r\nnxt_cntct_dt,\r\nslr_nxt_rvw_dt,\r\nrqst_crt_dt,\r\nrqst_cmpltd_dt,\r\nlast_actn_dt,\r\nlast_actn_entity_type,\r\nlast_actn_entity,\r\nca_hld_dt,\r\nca_hld_rsn,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_fact_requests_ca;\r\n\r\n\r\nDELETE uk_ent FROM ${tgt_db_schema}.`uk_fact_entities_ca` uk_ent  JOIN ${src_db_schema}.rpt_uk_fact_entities_ca rpt_ent ON  uk_ent.entity_id = rpt_ent.entity_id AND uk_ent.entity_type= rpt_ent.entity_type;\r\n\r\n\r\nINSERT INTO  ${tgt_db_schema}.`uk_fact_entities_ca`\r\n(\r\nentity_id,\r\nentity_type,\r\nca_rqst_sbtask_id,\r\nsbtask_type_cd,\r\nsbtask_cd,\r\nsbtask_status_cd,\r\nclose_rsn_cd,\r\nsla_cntct_dt,\r\nlast_cntct_dt,\r\nsbtask_cmpltd_dt,\r\ncntct_rslt_cd,\r\nsbtask_stg_cd,\r\nsbtask_crt_dt,\r\nca_rqst_task_id,\r\nca_rqst_id,\r\nnxt_cntct_dt,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at,\r\ntask_type_cd,\r\ntask_status_cd,\r\ntask_cmpltd_dt,\r\ntask_crt_dt\r\n)\r\n \r\n\r\nSELECT \r\nentity_id,\r\nentity_type,\r\nca_rqst_sbtask_id,\r\nsbtask_type_cd,\r\nsbtask_cd,\r\nsbtask_status_cd,\r\nclose_rsn_cd,\r\nsla_cntct_dt,\r\nlast_cntct_dt,\r\nsbtask_cmpltd_dt,\r\ncntct_rslt_cd,\r\nsbtask_stg_cd,\r\nsbtask_crt_dt,\r\nca_rqst_task_id,\r\nca_rqst_id,\r\nnxt_cntct_dt,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at,\r\ntask_type_cd,\r\ntask_status_cd,\r\ntask_cmpltd_dt,\r\ntask_crt_dt\r\nFROM ${src_db_schema}.rpt_uk_fact_entities_ca\r\n;\r\n\r\nDELETE uk_evt FROM ${tgt_db_schema}.`uk_fact_events_ca` uk_evt JOIN  ${src_db_schema}.rpt_uk_fact_events_ca rpt_evt ON uk_evt.ca_event_log_id = rpt_evt.ca_event_log_id ;\r\n\r\nINSERT INTO  ${tgt_db_schema}.`uk_fact_events_ca`\r\n(\r\nca_event_log_id,\r\nlot_nbr,\r\nref_cd,\r\nref_id,\r\nevent_cd,\r\nevent_notes,\r\nevent_json,\r\ntrgrd_by_entity,\r\ntrgrd_by,\r\ntrgrd_dt,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nca_event_log_id,\r\nlot_nbr,\r\nref_cd,\r\nref_id,\r\nevent_cd,\r\nevent_notes,\r\nevent_json,\r\ntrgrd_by_entity,\r\ntrgrd_by,\r\ntrgrd_dt,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_fact_events_ca;\r\n\r\n\r\nDELETE uk_msg FROM ${tgt_db_schema}.`uk_fact_message_ca` uk_msg JOIN ${src_db_schema}.rpt_uk_fact_message_ca rpt_msg ON uk_msg.entity_id =rpt_msg.entity_id AND uk_msg.entity_type = rpt_msg.entity_type;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`uk_fact_message_ca`\r\n(\r\nentity_id,\r\nentity_type,\r\nca_msg_dtl_id,\r\nfrom_entity_type,\r\nfrom_entity,\r\nto_entity_type,\r\nto_entity,\r\ncomments,\r\nmsg_dtl_json,\r\nmsg_dtl_ack_flg,\r\nmsg_dtl_status,\r\nca_msg_hdr_id,\r\nca_rqst_id,\r\nca_rqst_task_id,\r\nca_rqst_sbtask_id,\r\nmsg_cat_cd,\r\nmsg_type_cd,\r\nmsg_hdr_json,\r\nmsg_status,\r\nresp_entity,\r\nresp_entity_id,\r\nresp_comments,\r\nresp_type_cd,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\n\r\nSELECT \r\nentity_id,\r\nentity_type,\r\nca_msg_dtl_id,\r\nfrom_entity_type,\r\nfrom_entity,\r\nto_entity_type,\r\nto_entity,\r\ncomments,\r\nmsg_dtl_json,\r\nmsg_dtl_ack_flg,\r\nmsg_dtl_status,\r\nca_msg_hdr_id,\r\nca_rqst_id,\r\nca_rqst_task_id,\r\nca_rqst_sbtask_id,\r\nmsg_cat_cd,\r\nmsg_type_cd,\r\nmsg_hdr_json,\r\nmsg_status,\r\nresp_entity,\r\nresp_entity_id,\r\nresp_comments,\r\nresp_type_cd,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_fact_message_ca\r\n;\r\n\r\n\r\nDELETE dim_ratt FROM ${tgt_db_schema}.`dim_ca_request_attributes` dim_ratt  JOIN ${src_db_schema}.rpt_uk_dim_request_attributes_ca rpt_ratt ON dim_ratt.ca_rqst_attr_id = rpt_ratt.ca_rqst_attr_id ;\r\n\r\nINSERT INTO  ${tgt_db_schema}.`dim_ca_request_attributes`\r\n(\r\nca_rqst_attr_id,\r\nca_rqst_id,\r\nattr_type_cd,\r\nattr_json_val,\r\nattr_status,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nca_rqst_attr_id,\r\nca_rqst_id,\r\nattr_type_cd,\r\nattr_json_val,\r\nattr_status,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_request_attributes_ca\r\n;\r\n\r\nDELETE dim_sbta FROM ${tgt_db_schema}.`dim_ca_request_subtask_attributes` dim_sbta  JOIN ${src_db_schema}.rpt_uk_dim_request_subtask_attributes_ca rpt_sbta ON dim_sbta.ca_sbtask_attr_id = rpt_sbta.ca_sbtask_attr_id;\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_request_subtask_attributes`\r\n(\r\nca_sbtask_attr_id,\r\nca_rqst_sbtask_id,\r\nattr_type_cd,\r\nattr_json_val,\r\nattr_status,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nca_sbtask_attr_id,\r\nca_rqst_sbtask_id,\r\nattr_type_cd,\r\nattr_json_val,\r\nattr_status,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_request_subtask_attributes_ca\r\n;\r\n\r\n\r\nDELETE dim_stc FROM ${tgt_db_schema}.`dim_ca_subtask_type_codes` dim_stc  JOIN ${src_db_schema}.rpt_uk_dim_subtask_type_codes_ca rpt_stc ON dim_stc.sbtask_type_cd = rpt_stc.sbtask_type_cd;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_subtask_type_codes`\r\n(\r\nsbtask_type_cd,\r\nsbtask_type_desc,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nsbtask_type_cd,\r\nsbtask_type_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_subtask_type_codes_ca\r\n;\r\n\r\n\r\nDELETE dim_st FROM ${tgt_db_schema}.`dim_ca_subtask_types` dim_st  JOIN ${src_db_schema}.rpt_uk_dim_subtask_types_ca rpt_st ON dim_st.ca_task_type_cd = rpt_st.ca_task_type_cd AND dim_st.ca_sbtask_cd = rpt_st.ca_sbtask_cd AND dim_st.ca_sbtask_type_cd = rpt_st.ca_sbtask_type_cd;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_subtask_types`\r\n( \r\nca_task_type_cd,\r\nca_sbtask_type_cd,\r\nca_sbtask_cd,\r\nca_sbtask_desc,\r\nproperties_json,\r\ncntct_due_time,\r\ncntct_flup_time,\r\nsbtask_priority,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nca_task_type_cd,\r\nca_sbtask_type_cd,\r\nca_sbtask_cd,\r\nca_sbtask_desc,\r\nproperties_json,\r\ncntct_due_time,\r\ncntct_flup_time,\r\nsbtask_priority,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_subtask_types_ca\r\n;\r\n\r\n\r\n\r\nDELETE dim_tt FROM ${tgt_db_schema}.`dim_ca_task_types` dim_tt JOIN ${src_db_schema}.rpt_uk_dim_task_types_ca rpt_tt ON dim_tt.task_type_cd = rpt_tt.task_type_cd ;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_task_types`\r\n( \r\ntask_type_cd,\r\ntask_type_desc,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\ntask_type_cd,\r\ntask_type_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_task_types_ca\r\n;\r\n\r\n\r\nDELETE dim_sc FROM ${tgt_db_schema}.`dim_ca_status_codes` dim_sc  JOIN ${src_db_schema}.rpt_uk_dim_status_codes_ca rpt_sc ON dim_sc.ca_cat_cd = rpt_sc.ca_cat_cd AND dim_sc.ca_status_cd = rpt_sc.ca_status_cd;\r\n\r\n\r\n\r\nINSERT INTO  ${tgt_db_schema}.`dim_ca_status_codes` \r\n(\r\nca_cat_cd,\r\nca_status_cd,\r\nca_status_desc,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nca_cat_cd,\r\nca_status_cd,\r\nca_status_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_status_codes_ca\r\n;\r\n\r\n\r\nDELETE dim_s FROM ${tgt_db_schema}.`dim_ca_stages` dim_s  JOIN ${src_db_schema}.rpt_uk_dim_stages_ca rpt_s ON dim_s.ca_cat_cd = rpt_s.ca_cat_cd AND dim_s.ca_stg_cd = rpt_s.ca_stg_cd;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_stages`\r\n( \r\nca_cat_cd,\r\nca_stg_cd,\r\nca_stg_desc,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nca_cat_cd,\r\nca_stg_cd,\r\nca_stg_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_stages_ca\r\n;\r\n\r\nDELETE  dim_rc FROM ${tgt_db_schema}.`dim_ca_reference_codes` dim_rc  JOIN ${src_db_schema}.rpt_uk_dim_reference_codes_ca rpt_rc ON dim_rc.ca_ref_cat_cd = rpt_rc.ca_ref_cat_cd AND dim_rc.ca_ref_cd = rpt_rc.ca_ref_cd;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_reference_codes`\r\n(\r\nca_ref_cat_cd,\r\nca_ref_cd,\r\nca_ref_desc,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)	\r\nSELECT \r\nca_ref_cat_cd,\r\nca_ref_cd,\r\nca_ref_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_reference_codes_ca\r\n;\r\n\r\n\r\nDELETE dim_rf FROM ${tgt_db_schema}.`dim_ca_reference_categories` dim_rf  JOIN ${src_db_schema}.rpt_uk_dim_reference_categories_ca rpt_rf ON dim_rf.ca_ref_cat_cd = rpt_rf.ca_ref_cat_cd ;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_reference_categories`\r\n(\r\nca_ref_cat_cd,\r\nca_ref_cat_desc,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nca_ref_cat_cd,\r\nca_ref_cat_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_reference_categories_ca\r\n;\r\n\r\nDELETE dim_rc FROM ${tgt_db_schema}.`dim_ca_reason_codes` dim_rc JOIN ${src_db_schema}.rpt_uk_dim_reason_codes_ca rpt_rc ON dim_rc.ca_rsn_cd = rpt_rc.ca_rsn_cd AND dim_rc.ca_rsn_cat_cd = rpt_rc.ca_rsn_cat_cd ;\r\n\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_reason_codes`\r\n(\r\nca_rsn_cat_cd,\r\nca_rsn_cd,\r\nca_rsn_desc,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nca_rsn_cat_cd,\r\nca_rsn_cd,\r\nca_rsn_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_reason_codes_ca\r\n;\r\n\r\n\r\nDELETE dim_ca FROM ${tgt_db_schema}.`dim_ca_reason_categories` dim_ca JOIN ${src_db_schema}.rpt_uk_dim_reason_categories_ca rpt_ca ON dim_ca.ca_rsn_cat_cd = rpt_ca.ca_rsn_cat_cd ;\r\n\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_reason_categories`\r\n(\r\nca_rsn_cat_cd,\r\nca_rsn_cat_desc,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nca_rsn_cat_cd,\r\nca_rsn_cat_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID} batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_reason_categories_ca\r\n;\r\n\r\n\r\nDELETE dim_mt FROM ${tgt_db_schema}.`dim_ca_message_types` dim_mt JOIN ${src_db_schema}.rpt_uk_dim_message_types_ca rpt_mt ON dim_mt.msg_cat_cd = rpt_mt.msg_cat_cd AND dim_mt.msg_type_cd = rpt_mt.msg_type_cd;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_message_types`\r\n(\r\nmsg_cat_cd,\r\nmsg_type_cd,\r\nmsg_type_desc,\r\nmsg_type_json,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nmsg_cat_cd,\r\nmsg_type_cd,\r\nmsg_type_desc,\r\nmsg_type_json,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_message_types_ca\r\n;\r\n\r\nDELETE dim_mc FROM ${tgt_db_schema}.`dim_ca_message_categories` dim_mc JOIN ${src_db_schema}.rpt_uk_dim_message_categories_ca rpt_mc ON dim_mc.msg_cat_cd = rpt_mc.msg_cat_cd ;\r\n\r\n\r\nINSERT INTO ${tgt_db_schema}.`dim_ca_message_categories` \r\n( \r\nmsg_cat_cd,\r\nmsg_cat_desc,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nmsg_cat_cd,\r\nmsg_cat_desc,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_message_categories_ca;\r\n\r\n\r\nDELETE dim_at FROM ${tgt_db_schema}.`dim_ca_attribute_types` dim_at  JOIN ${src_db_schema}.rpt_uk_dim_attribute_types_ca rpt_at ON dim_at.attr_type_cat_cd = rpt_at.attr_type_cat_cd AND dim_at.attr_type_cd = rpt_at.attr_type_cd;\r\n\r\n\r\n\r\nINSERT INTO  ${tgt_db_schema}.`dim_ca_attribute_types` \r\n(\r\nattr_type_cat_cd,\r\nattr_type_cd,\r\nattr_type_nm,\r\nSTATUS,\r\nbatch_nbr,\r\ncreated_dt,\r\nupdated_at\r\n)\r\nSELECT \r\nattr_type_cat_cd,\r\nattr_type_cd,\r\nattr_type_nm,\r\nSTATUS,\r\n${OUT_BATCH_ID}  batch_nbr,\r\nCURRENT_TIMESTAMP AS created_dt,\r\nCURRENT_TIMESTAMP AS updated_at\r\nFROM ${src_db_schema}.rpt_uk_dim_attribute_types_ca;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n','NA',NULL,'NA',NULL,'2022-04-20 05:36:53','NA','NA',NULL,NULL,NULL,NULL,'1',NULL,'Y','DS_USMART_TGT','DS_USMART_TGT','SELECT 1 AS \'Check\',\r\n	COUNT(*) AS src_valid_cnt;','select  1 as \'Check\',\r\n	count(*) as tgt_valid_cnt;');
